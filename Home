<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rate My Preceptor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .preceptor-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        .review-form, .add-preceptor-form {
            margin-top: 20px;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }
        button {
            margin-top: 15px;
            padding: 10px 20px;
            background-color: #0077cc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #005fa3;
        }
    </style>
</head>
<body>

    <h1>Rate My Preceptor</h1>

    <!-- Search -->
    <input type="text" id="searchBox" placeholder="Search for a preceptor..." onkeyup="searchPreceptors()">

    <button onclick="toggleAddPreceptorForm()">Add New Preceptor</button>

    <!-- Add Preceptor Form -->
    <div id="addPreceptorSection" style="display:none;" class="add-preceptor-form">
        <h2>Add a New Preceptor</h2>
        <form id="addPreceptorForm">
            <label for="newName">Preceptor Name:</label>
            <input type="text" id="newName" required>

            <label for="newLocation">Location (School/Facility):</label>
            <input type="text" id="newLocation" required>

            <label for="recommend">Would you recommend this preceptor?</label>
            <select id="recommend" required>
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>

            <label for="hours">Hours per week:</label>
            <input type="number" id="hours" required min="1">

            <label for="dressCode">Dress code:</label>
            <input type="text" id="dressCode" required>

            <button type="submit">Add Preceptor</button>
        </form>
    </div>

    <!-- List of Preceptors -->
    <div id="preceptorList"></div>

    <!-- Review Form -->
    <div id="reviewSection" style="display:none;" class="review-form">
        <h2>Leave a Review for <span id="preceptorName"></span></h2>
        <form id="reviewForm">
            <label for="rating">Rating (1–5):</label>
            <select id="rating" required>
                <option value="">Select rating</option>
                <option value="5">5 - Excellent</option>
                <option value="4">4 - Good</option>
                <option value="3">3 - Average</option>
                <option value="2">2 - Poor</option>
                <option value="1">1 - Terrible</option>
            </select>

            <label for="comments">Comments:</label>
            <textarea id="comments" rows="5" required></textarea>

            <button type="submit">Submit Review</button>
        </form>
    </div>

    <script>
        // Initialize preceptors
        let preceptors = JSON.parse(localStorage.getItem('preceptors')) || [];

        function savePreceptors() {
            localStorage.setItem('preceptors', JSON.stringify(preceptors));
        }

        function renderPreceptors() {
            const list = document.getElementById('preceptorList');
            list.innerHTML = '';
            preceptors.forEach((preceptor, index) => {
                const card = document.createElement('div');
                card.className = 'preceptor-card';
                card.innerHTML = `
                    <h3>${preceptor.name}</h3>
                    <p><strong>Location:</strong> ${preceptor.location}</p>
                    <p><strong>Recommend?</strong> ${preceptor.recommend}</p>
                    <p><strong>Hours/week:</strong> ${preceptor.hours}</p>
                    <p><strong>Dress Code:</strong> ${preceptor.dressCode}</p>
                    <button onclick="showReviewForm(${index})">Leave a Review</button>
                    <div>
                        <h4>Reviews:</h4>
                        ${preceptor.reviews.map(r => `
                            <p>⭐ ${r.rating} - ${r.comments}</p>
                        `).join('') || '<p>No reviews yet.</p>'}
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function toggleAddPreceptorForm() {
            const section = document.getElementById('addPreceptorSection');
            section.style.display = section.style.display === 'none' ? 'block' : 'none';
        }

        document.getElementById('addPreceptorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newPreceptor = {
                name: document.getElementById('newName').value,
                location: document.getElementById('newLocation').value,
                recommend: document.getElementById('recommend').value,
                hours: document.getElementById('hours').value,
                dressCode: document.getElementById('dressCode').value,
                reviews: []
            };
            preceptors.push(newPreceptor);
            savePreceptors();
            renderPreceptors();
            document.getElementById('addPreceptorForm').reset();
            document.getElementById('addPreceptorSection').style.display = 'none';
        });

        let currentPreceptorIndex = null;

        function showReviewForm(index) {
            currentPreceptorIndex = index;
            document.getElementById('preceptorName').innerText = preceptors[index].name;
            document.getElementById('reviewSection').style.display = 'block';
            window.scrollTo(0, document.body.scrollHeight);
        }

        document.getElementById('reviewForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const review = {
                rating: document.getElementById('rating').value,
                comments: document.getElementById('comments').value
            };
            preceptors[currentPreceptorIndex].reviews.push(review);
            savePreceptors();
            renderPreceptors();
            document.getElementById('reviewForm').reset();
            document.getElementById('reviewSection').style.display = 'none';
        });

        function searchPreceptors() {
            const input = document.getElementById('searchBox').value.toLowerCase();
            const cards = document.getElementsByClassName('preceptor-card');

            for (let card of cards) {
                const name = card.getElementsByTagName('h3')[0].innerText.toLowerCase();
                if (name.includes(input)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            }
        }

        // Initial render
        renderPreceptors();
    </script>

</body>
</html>
